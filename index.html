<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BKI Deploy - PT Bangga Karya Indonesia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #050505; color: #fff; overflow-x: hidden; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .blue-gradient { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        .text-gradient { background: linear-gradient(to right, #fff, #94a3b8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .fade-out { opacity: 0; transition: opacity 0.5s ease; pointer-events: none; }
        .fade-in { animation: fadeIn 0.5s forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="app-container">
        
        <section id="home-page" class="min-h-screen flex flex-col items-center justify-center px-6 relative text-center">
            <div class="absolute top-0 left-1/2 -translate-x-1/2 w-[600px] h-[300px] bg-blue-600/10 blur-[120px] rounded-full"></div>

            <div class="relative z-10 max-w-3xl">
                <div class="inline-block px-4 py-1.5 mb-6 rounded-full glass text-[10px] font-bold tracking-[0.2em] text-blue-400 uppercase">
                    BKI Cloud Infrastructure
                </div>
                <h1 class="text-5xl md:text-7xl font-extrabold mb-6 tracking-tight text-gradient leading-tight">
                    Upload File, <br> Jadi Web Publik.
                </h1>
                <p class="text-gray-400 text-lg mb-10 leading-relaxed max-w-2xl mx-auto">
                    Platform deployment mandiri milik <strong>PT Bangga Karya Indonesia</strong>. 
                    Tinggal pilih file HTML Anda dan langsung online.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-12 text-left">
                    <div class="p-5 glass rounded-2xl">
                        <div class="text-blue-500 font-bold mb-1">Upload File</div>
                        <p class="text-[11px] text-gray-500">Pilih file .html langsung dari galeri atau folder Anda.</p>
                    </div>
                    <div class="p-5 glass rounded-2xl">
                        <div class="text-blue-500 font-bold mb-1">Global Access</div>
                        <p class="text-[11px] text-gray-500">Website dapat diakses siapapun dengan link unik.</p>
                    </div>
                    <div class="p-5 glass rounded-2xl">
                        <div class="text-blue-500 font-bold mb-1">Instant Live</div>
                        <p class="text-[11px] text-gray-500">Tanpa proses build yang lama, langsung aktif.</p>
                    </div>
                </div>

                <div class="flex flex-col items-center gap-6">
                    <button onclick="startDeploy()" class="blue-gradient px-12 py-5 rounded-full font-bold text-lg hover:scale-105 transition shadow-[0_0_40px_rgba(59,130,246,0.3)]">
                        Start Deploy Now
                    </button>
                    <div class="flex items-center gap-2 opacity-50">
                        <span class="text-xs">Project by:</span>
                        <span class="text-xs font-bold text-blue-400">@maramadhona</span>
                    </div>
                </div>
            </div>
        </section>

        <section id="deploy-page" class="hidden min-h-screen py-12 px-6 fade-in">
            <div class="max-w-2xl mx-auto">
                <div class="flex items-center justify-between mb-10 border-b border-white/5 pb-6">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 blue-gradient rounded-xl flex items-center justify-center font-bold text-white">B</div>
                        <h2 class="text-xl font-bold">BKI Engine</h2>
                    </div>
                    <button onclick="location.reload()" class="text-xs text-gray-500 hover:text-white transition">← Kembali</button>
                </div>

                <div class="glass rounded-3xl p-8 shadow-2xl space-y-8">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-3 ml-1 text-blue-400">1. Tentukan Nama Website</label>
                        <div class="flex items-center gap-3 bg-black/40 border border-white/10 p-4 rounded-2xl focus-within:border-blue-500/50 transition">
                            <span class="text-gray-600 text-sm">Rloy.app/</span>
                            <input type="text" id="slug" placeholder="nama-proyek" class="bg-transparent border-none outline-none text-white w-full font-semibold">
                        </div>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-3 ml-1 text-blue-400">2. Pilih File HTML</label>
                        <div onclick="document.getElementById('file-input').click()" class="border-2 border-dashed border-white/10 p-8 rounded-2xl text-center hover:border-blue-500/50 cursor-pointer bg-white/5 transition">
                            <input type="file" id="file-input" accept=".html" class="hidden" onchange="handleFile(this)">
                            <div id="file-info" class="text-gray-400">
                                <p class="text-sm font-semibold">Klik untuk memilih file .html</p>
                                <p class="text-[10px] mt-1 text-gray-600 uppercase">Maksimal 1MB</p>
                            </div>
                        </div>
                    </div>

                    <button onclick="publishToCloud()" id="btn-publish" class="w-full blue-gradient py-5 rounded-2xl font-bold text-lg shadow-lg transform active:scale-95 transition">
                        Luncurkan Website
                    </button>

                    <div id="result" class="hidden p-6 bg-blue-500/10 border border-blue-500/30 rounded-2xl text-center animate-bounce mt-4">
                        <p class="text-blue-400 text-xs font-bold uppercase mb-2">Website sudah online!</p>
                        <input type="text" id="share-url" readonly class="w-full bg-black/50 border border-white/5 p-3 rounded-xl text-xs text-center mb-4 text-blue-200 outline-none">
                        <button onclick="copyUrl()" class="px-8 py-2 bg-white text-black rounded-full font-bold text-xs hover:bg-gray-200 transition">Salin Link</button>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyA_caHmq9ayqjRLvdflwDrFsaJS-L282a4",
            authDomain: "deploy-3ff5a.firebaseapp.com",
            databaseURL: "https://deploy-3ff5a-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "deploy-3ff5a",
            storageBucket: "deploy-3ff5a.firebasestorage.app",
            messagingSenderId: "759372904208",
            appId: "1:759372904208:web:3ecee87189ba8a95aad795",
            measurementId: "G-Q79FBB907T"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        let fileContent = "";

        function startDeploy() {
            const home = document.getElementById('home-page');
            const deploy = document.getElementById('deploy-page');
            home.classList.add('fade-out');
            setTimeout(() => {
                home.style.display = 'none';
                deploy.classList.remove('hidden');
                window.scrollTo(0,0);
            }, 500);
        }

        // FUNGSI MEMBACA FILE
        function handleFile(input) {
            const file = input.files[0];
            const fileInfo = document.getElementById('file-info');
            
            if (file) {
                if (file.size > 1024 * 1024) {
                    alert("File terlalu besar! Maksimal 1MB.");
                    input.value = "";
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    fileContent = e.target.result;
                    fileInfo.innerHTML = `<p class="text-blue-400 font-bold text-sm">✓ ${file.name}</p><p class="text-[10px] text-gray-500 uppercase">File siap dideploy</p>`;
                };
                reader.readAsText(file);
            }
        }

        function publishToCloud() {
            const slug = document.getElementById('slug').value.trim().replace(/\s+/g, '-').toLowerCase();
            
            if(!slug) return alert("Beri nama website Anda!");
            if(!fileContent) return alert("Silakan pilih file HTML terlebih dahulu!");

            const btn = document.getElementById('btn-publish');
            btn.innerText = "Processing Cloud...";
            btn.disabled = true;

            database.ref('sites/' + slug).set({
                content: fileContent,
                createdAt: Date.now()
            }, (error) => {
                btn.innerText = "Luncurkan Website";
                btn.disabled = false;
                if (error) alert("Gagal deploy.");
                else {
                    const finalUrl = window.location.origin + window.location.pathname + "?w=" + slug;
                    document.getElementById('share-url').value = finalUrl;
                    document.getElementById('result').classList.remove('hidden');
                }
            });
        }

        function copyUrl() {
            const copyText = document.getElementById('share-url');
            copyText.select();
            document.execCommand('copy');
            alert("URL disalin ke clipboard!");
        }

        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const webName = urlParams.get('w');
            if (webName) {
                document.getElementById('app-container').innerHTML = "<div style='height:100vh; display:flex; align-items:center; justify-content:center; color:#333; font-size:10px; letter-spacing:3px;'>BKI CLOUD LOADING...</div>";
                database.ref('sites/' + webName).once('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        document.open();
                        document.write(data.content);
                        document.close();
                    } else {
                        document.body.innerHTML = "Project Not Found";
                    }
                });
            }
        };
    </script>
</body>
</html>
